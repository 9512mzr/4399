var _util=OT2.Util;OT2.Global={initPage:function(){this.goTop(),this.searchMenu(),this.topNavMenu(),this.topheadMenu(),this.toggleSearchTypes();var i=this;$(function(){i.strcut(),"function"==typeof user_news&&user_news()})},goTop:function(i){var t=1200;"undefined"!=typeof SIZE&&(t="XL"==SIZE?1200:1e3);var o=i,n=function(){var i=$(window).width();if(i>t){var n=(i-t)/2-70;o.css("right",n+"px")}};o||((o=$('<a class="return" href="javascript:;"><i class="icona-top"></i></a>')).appendTo(document.body),n()),o.on("click",function(){o.hide(),void 0===window.dispatchEvent?$("html, body").scrollTop(0):$("html, body").animate({scrollTop:0},"fast")});var e=$(window).height();$(window).on("scroll",function(){H=Math.max.call(null,document.documentElement.scrollTop,document.body.scrollTop),o[H>e/2?"show":"hide"]()}),$(window).on("resize",n)},searchMenu:function(){var i=$("#J_SearchMenu"),t=i.find(".select-items"),o=i.find(".J_tit");i.hover(function(){t.show()},function(){t.hide()}),i.on("click","a",function(){var i=$(this);i.find("input").prop("checked",!0);var n=$.trim(i.find("input").val());n=0===n.indexOf("/")?n:"/"+n,i.parents().find("form").attr({action:n});var e=i.find("span").text();o.text(e),t.hide()})},topNavMenu:function(){var i=$(".nav-items"),t=i.find(".item-list");_util.dropList(i,t,500)},topheadMenu:function(){$(".topbar-dropmap").each(function(){var i=$(this).find(".drop-bd");_util.dropList($(this),i,300)})},toggleSearchTypes:function(){var i=$('<span class="show-more">更多<i></i></span>'),t=function(t){var o=$(t),n=o.hasClass("expand-mode");if(o.find(".con-items").height()<=40)return!0;var e=i.clone().appendTo(t);e.on("click",function(){o[(n=!n)?"addClass":"removeClass"]("expand-mode")});o.find(".type-active").position().top>5&&!n&&e.trigger("click")};$(".search-type").find("div.type-con").each(function(){t(this)}),$(".tag-type").find("div.tag-con").each(function(){t(this)})},strcut:function(){$("[data-cut]").each(function(){var i=parseInt($(this).data("cut"),10),t=$(this).text();t.length>i&&($(this).text(t.substr(0,i)+"..."),$(this).attr("title",t))})},initLogin:function(i){return void 0!==USER.uid&&0!=USER.uid?!i||(window.location=i,!1):void 0!==this.LoginModal?(this.LoginModal.formObj.clearError(),this.LoginModal.show(i),!1):(this.LoginModal={init:function(){var i=this;return this.$el=$("#Login_Pal"),this.$form=this.$el.find(".reg-form").first(),OT2.UserForm.initPlaceholder(),this.formObj=new OT2.UserForm.Login,this.formObj.$form=this.$el.find("#J_LoginForm"),this.formObj.init(),this.$form.find(".checkbox").each(function(){new OT2.Element.checkbox(this).bindEvent()}),this.$form.find(".J_CloseForm").on("click",function(){i.$el.hide()}),this},show:function(i){this.$el.show();var t=document.body.scrollTop||document.documentElement.scrollTop,o=($(window).height()-this.$form.height())/2;this.$form.css("top",t+o),this.formObj.returnurl=i}},this.LoginModal.init().show(i),!1)}},OT2.Global.initPage(),$(document).ajaxError(function(i,t,o){if(401==t.status&&t.responseText)if(dialog){var n=dialog({id:"_dialog_ajax_verify_intercept",content:t.responseText,title:"安全验证"});window._ajax_verify_success_callback=function(){n.remove(),$.ajax(o)},n.showModal()}else alert("无权限操作，请联系管理员！")});